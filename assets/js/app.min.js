


// ----------------------------------------------------//
// --    Перетворення <img> із SVG на inline SVG     --//
// ----------------------------------------------------//
const convertImages = (query, callback) => {
  document.querySelectorAll(query).forEach(image => {
    // Отримуємо SVG-файл
    fetch(image.src)
      .then(res => res.text())
      .then(data => {
        // Парсимо SVG як XML
        const svg = new DOMParser()
          .parseFromString(data, 'image/svg+xml')
          .querySelector('svg');

        if (!svg) return;

        // Копіюємо id та класи з <img> до <svg>
        if (image.id) svg.id = image.id;
        if (image.className) svg.setAttribute('class', image.className);

        // Замінюємо <img> на inline <svg>
        image.replaceWith(svg);

        if (typeof callback === 'function') callback(svg);
      })
      .catch(console.error);
  });
};

// Викликаємо для всіх <img>
convertImages('.svg');
// 


// ----------------------------------------------------//
// -- Копіювання посилання гугл координатів в буфер  --//
// ----------------------------------------------------//
// Додаємо обробник після завантаження DOM
document.addEventListener('DOMContentLoaded', function () {
  if (document.querySelector('.copy-link')) {
    // Для кожного елемента .copy-link додаємо обробник кліку
    document.querySelectorAll('.copy-link').forEach(link => {
      link.addEventListener('click', function (e) {
        e.preventDefault(); // Відміна переходу за посиланням

        // Отримуємо URL з найближчого блоку .location
        const url = this.closest('.location').querySelector('a').href;

        // Показуємо підказку "Скопійовано"
        const showTooltip = (el, text) => {
          const tooltip = document.createElement('div');
          tooltip.className = 'copy-tooltip';
          tooltip.textContent = text;
          document.body.appendChild(tooltip);

          const rect = el.getBoundingClientRect();
          tooltip.style.left = `${rect.left + window.scrollX}px`;
          tooltip.style.top = `${rect.top + window.scrollY - 30}px`;
          tooltip.style.opacity = 1;

          setTimeout(() => {
            tooltip.style.opacity = 0;
            setTimeout(() => tooltip.remove(), 300);
          }, 1500);
        };

        const text = this.dataset.text || 'Скопійовано';

        // Копіюємо URL через Clipboard API або execCommand
        if (navigator.clipboard && navigator.clipboard.writeText) {
          navigator.clipboard.writeText(url)
            .then(() => showTooltip(this, text))
            .catch(err => console.error('Clipboard error:', err));
        } else {
          const textarea = document.createElement('textarea');
          textarea.value = url;
          document.body.appendChild(textarea);
          textarea.select();
          try {
            document.execCommand('copy');
            showTooltip(this, text);
          } catch (err) {
            console.error('execCommand error:', err);
          }
          document.body.removeChild(textarea);
        }
      });
    });
  }
});



document.addEventListener('DOMContentLoaded', function () {

  const popUpClose = document.querySelectorAll('.pop-up__close');

  popUpClose.forEach(item => {
    item.addEventListener('click', function (e) {
      e.preventDefault();
      // Закриваємо Fancybox
      Fancybox.close();
    })
  })
})


// ----------------------------------------------------//
// --                   Маска телефона               --//
// ----------------------------------------------------//
document.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('.phone-input').forEach(function (input) {
    const im = new Inputmask("+389 (99) 999-99-99");
    im.mask(input);
  });
});


// ----------------------------------------------------//
// --                 Аккордеон FAQ                  --//
// ----------------------------------------------------//
document.addEventListener('DOMContentLoaded', function () {
  const faqItem = document.querySelectorAll(".faq2__item");
  faqItem.forEach((item) => {

    item.addEventListener("click", () => {
      item.classList.add("active");
      faqItem.forEach((el) => {
        if (el !== item) {
          el.classList.remove("active");
        }
      });
    });
  });
});


// ----------------------------------------------------//
// --                   Слайдери                     --//
// ----------------------------------------------------//
(() => {
  // 
  if (document.querySelector(".lawyers-slider__slider")) new Swiper(".lawyers-slider__slider", {
    slidesPerView: 1,
    spaceBetween: 0,
    navigation: {
      prevEl: ".lawyers-slider__prev",
      nextEl: ".lawyers-slider__next"
    },
    breakpoints: {
      700: {
        slidesPerView: 2,
        spaceBetween: 10,
      },
      1050: {
        slidesPerView: 3,
        spaceBetween: 24,
      },
      1550: {
        slidesPerView: 4,
        spaceBetween: 24,
      }
    },
  });

  if (document.querySelector(".example2__slider")) new Swiper(".example2__slider", {
    slidesPerView: 1,
    spaceBetween: 0,
    navigation: {
      prevEl: ".example2__prev",
      nextEl: ".example2__next"
    },
    pagination: {
      el: ".example2__pagination",
      type: "bullets",
      clickable: true
    }
  });
  // 
  if (document.querySelector(".military-law__slider")) new Swiper(".military-law__slider", {
    slidesPerView: 1,
    spaceBetween: 0,
    navigation: {
      prevEl: ".military-law__prev",
      nextEl: ".military-law__next"
    },
    scrollbar: {
      el: ".military-law__slide",
      draggable: true,
    },
    watchOverflow: true,


    breakpoints: {
      500: {
        slidesPerView: 2,
        spaceBetween: 24,
      },
      768: {
        slidesPerView: 1,
        spaceBetween: 0,
      },
      916: {
        slidesPerView: 2,
        spaceBetween: 24,
      },
      1450: {
        slidesPerView: 5,
        spaceBetween: 20,
      }
    },
  });


  if(window.innerWidth > 1400) {
    
    if (document.querySelector(".how_works__slider")) {
      const swiper = new Swiper(".how_works__slider", {
        slidesPerView: 1.2,
        spaceBetween: 15,
        navigation: {
          prevEl: ".how_works__prev",
          nextEl: ".how_works__next"
        },
        breakpoints: {
          560: { slidesPerView: 2, spaceBetween: 15 },
          1120: { slidesPerView: 3, spaceBetween: 15 },
          1461: { slidesPerView: 4, spaceBetween: 15 },
          1800: { slidesPerView: 5, spaceBetween: 15 }
        },
        on: {
          init: function () {
            checkSlides(this);
          },
          resize: function () {
            checkSlides(this);
          }
        }
      });

      // функція перевірки
      function checkSlides(swiper) {
        const total = swiper.slides.length; // всі слайди
        const perView = swiper.params.slidesPerView; // параметр slidesPerView (може бути дробовим)

        // якщо кількість слайдів менша або дорівнює видимим
        if (total <= Math.ceil(perView)) {
          document.querySelector(".how_works__more").style.display = "none";
        } else {
          document.querySelector(".how_works__more").style.display = "";
        }
      }
    }

}



  if (document.querySelector(".reviews-slider2__grid")) new Swiper(".reviews-slider2__grid", {
    slidesPerView: 1,
    spaceBetween: 0,
    navigation: {
      prevEl: ".rreviews-slider2__prev",
      nextEl: ".rreviews-slider2__next"
    },
    breakpoints: {
      700: {
        slidesPerView: 2,
        spaceBetween: 10,
      },
      910: {
        slidesPerView: 3,
        spaceBetween: 24,
      },
      1190: {
        slidesPerView: 4,
        spaceBetween: 24,
      },
      1580: {
        slidesPerView: 5,
        spaceBetween: 24,
      },

    },
  });

})();


// ----------------------------------------------------//
// --                   fancybox                     --//
// ----------------------------------------------------//
// Fancybox.bind("[data-fancybox]", {
//   // Your custom options
// });
// Ініціалізація Fancybox
// Ініціалізація fancybox
Fancybox.bind("[data-fancybox]", {
  on: {
    done: (fancybox, slide) => {
      // елемент по якому клікнули
      const trigger = slide.triggerEl;

      // беремо data-source
      const source = trigger.dataset.source;

      document.querySelectorAll('[name="source"]').forEach(input => {
        if (input) {
          input.value = source;
        }
      })
    }
  }
});




document.addEventListener('wpcf7mailsent', function (event) {
  Fancybox.close();
  Fancybox.show([{ src: "#pop-up-thank", type: "inline" }]);
}, false);


// ----------------------------------------------------//
// --             header__burger                     --//
// ----------------------------------------------------//
document.addEventListener("DOMContentLoaded", function () {

  const headerBurger = document.querySelector(".header__burger");
  const mobileMenu = document.querySelector(".mobile-menu");
  const mobileMenuClose = document.querySelector(".mobile-menu-close");
  const body = document.querySelector("body");

  // відкриття/закриття при кліку на бургер
  headerBurger.addEventListener("click", function (e) {
    e.stopPropagation(); // не передаємо клік далі
    headerBurger.classList.add("active");
    body.classList.add("overflow-hidden");
    mobileMenu.classList.add("active");
  });

  mobileMenuClose.addEventListener("click", function (e) {
    e.stopPropagation(); // не передаємо клік далі
    headerBurger.classList.remove("active");
    body.classList.remove("overflow-hidden");
    mobileMenu.classList.remove("active");
  });

  // закриття при кліку поза меню
  document.addEventListener("click", function (e) {
    const isClickInside = mobileMenu.contains(e.target) || headerBurger.contains(e.target);
    if (!isClickInside && mobileMenu.classList.contains("active")) {
      mobileMenu.classList.remove("active");
      headerBurger.classList.remove("active");
      body.classList.remove("overflow-hidden");
    }
  });
});